<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Choosing Minimal N and P · ParticleScattering.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ParticleScattering.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="tutorial1.html">Tutorial 1: Solving a Simple Multiple-Scattering Problem</a></li><li><a class="toctext" href="tutorial2.html">Tutorial 2: Accelerating Solutions with FMM</a></li><li><a class="toctext" href="tutorial_optim_angle.html">Tutorial 3: Angle Optimization</a></li><li><a class="toctext" href="tutorial_optim_radius.html">Tutorial 4: Radius Optimization</a></li></ul></li><li class="current"><a class="toctext" href="minimalNP.html">Choosing Minimal N and P</a><ul class="internal"><li><a class="toctext" href="#Discretization-Parameter-N-1">Discretization Parameter N</a></li><li><a class="toctext" href="#Multipole-Parameter-P-1">Multipole Parameter P</a></li></ul></li><li><a class="toctext" href="api.html">API</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="minimalNP.html">Choosing Minimal N and P</a></li></ul><a class="edit-page" href="https://github.com/bblankrot/ParticleScattering.jl/blob/master/docs/src/minimalNP.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Choosing Minimal N and P</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="minimalNP-1" href="#minimalNP-1">Choosing Minimal N and P</a></h1><h2><a class="nav-anchor" id="Discretization-Parameter-N-1" href="#Discretization-Parameter-N-1">Discretization Parameter N</a></h2><p>For each non-circular shape in a given scattering problem, we must choose the number of discretization nodes <code>2N</code> that not only fulfills some accuracy requirement, but also is not large enough to slows down the solution process. Although each shape is only solved or once in the pre-processing stage, with <span>$O(N^3)$</span> time complexity this stage can be slower than the system matrix solution for large values of <code>N</code>.</p><p>As the relationship between <code>N</code> and the resulting error depends not only on the geometry and diameter of the shape, but also on the wavelengths inside and outside of it, a general approach to computing <code>N</code> is crucial for dependable results. Moreover, there are many ways to quantify the error for a given discretization. Here we utilize a fictitious-source approach: the potential densities <span>$\sigma$</span>, <span>$\mu$</span> are solved for assuming (for example) a plane wave outside the particle and a line source inside it. The fields induced by these densities outside the particle should then be equal to that of the line source, up to some error. Specifically, this error is measured on a circle of radius</p><pre><code class="language-julia">R_multipole*maximum(hypot.(s.ft[:,1],s.ft[:,2]))</code></pre><p>as this is the scattering disk on which the translation to cylindrical harmonics (Bessel &amp; Hankel functions) are performed (and beyond which any gain or loss of accuracy due to <code>N</code> is mostly irrelevant).</p><p>Above a certain <code>N</code>, this error tends to decay as <span>$O(N^{-3})$</span>, but with a multiplicative factor that is heavily dependent on the particle and wavelength. With <code>minimumN</code>, we first guess a value and then use a binary search to find the minimal <code>N</code> satisfying some error tolerance <code>tol</code>:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="ParticleScattering.minimumN" href="#ParticleScattering.minimumN"><code>ParticleScattering.minimumN</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">minimumN(kout, kin, shape_function; tol = 1e-9, N_points = 10_000,
    N_start = 400, N_min = 100, N_max = 1_000) -&gt; N, err</code></pre><p>Return the minimum <code>N</code> necessary (i.e. <code>2N</code> nodes) to achieve error of at most <code>tol</code> in the electric field for a <code>ShapeParams</code> inclusion created by <code>shape_function(N)</code> which is filled with material of wavenumber <code>kin</code> and surrounded by free space with wavenumber <code>k0</code>. Error is calculated on <code>N_points</code> points on the scattering disk (<code>s.R</code>), by assuming a fictitious line source and comparing its field to that produced by the resulting potential densities.</p><p>Since for moderate wavelengths and errors, <span>$arepsilon \propto N^3$</span>, we estimate <code>N</code> using the error of <code>N_start</code>, then binary search based on that guess between <code>N_min</code> and <code>N_max</code>.</p></div><a class="source-link" target="_blank" href="https://github.com/bblankrot/ParticleScattering.jl/blob/72ac2ddd4b7fc1cd9aea176711fef1e5a5568b78/src/minimum_N_P.jl#L1-L16">source</a></section><h2><a class="nav-anchor" id="Multipole-Parameter-P-1" href="#Multipole-Parameter-P-1">Multipole Parameter P</a></h2><footer><hr/><a class="previous" href="tutorial_optim_radius.html"><span class="direction">Previous</span><span class="title">Tutorial 4: Radius Optimization</span></a><a class="next" href="api.html"><span class="direction">Next</span><span class="title">API</span></a></footer></article></body></html>
